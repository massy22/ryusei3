# mod_rewrite エンジンを有効化
RewriteEngine On

# サーバー上のベースディレクトリを指定
RewriteBase /ryusei3/

# ----------------------------------------------------
# 0. 特定のクエリ文字列を恒久削除 (410 GONE) にする
# ----------------------------------------------------
# メニューバー (MenuBar.html)
RewriteCond %{QUERY_STRING} ^MenuBar\.html$
RewriteRule ^$ - [G,L]

# InterWikiName (InterWikiName.html)
RewriteCond %{QUERY_STRING} ^InterWikiName\.html$
RewriteRule ^$ - [G,L]


# ----------------------------------------------------
# 1. 特殊文字の置換が必要なケース（FAQの〜を - に置換）
#    -> エンコード差異を吸収するため、ワイルドカードでマッチし、リダイレクト先は直接指定
# ----------------------------------------------------
# FAQ〜よくある質問.html
# 元のクエリ文字列でFAQとよくある質問の間をワイルドカードで受け入れる
RewriteCond %{QUERY_STRING} ^FAQ.*%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E8%B3%AA%E5%95%8F\.html$
# リダイレクト先を直接指定し、クエリを破棄 (QSD)
RewriteRule ^$ /ryusei3/docs/FAQ-よくある質問/ [R=301,L,QSD]


# ----------------------------------------------------
# 2. 特殊文字の置換が必要なケース（ストーリー攻略の〜 と ・ を - に置換）
#    -> 第X話、〜、中黒、ファイル名の4要素をキャプチャし置換
# ----------------------------------------------------
# パターン: %1 (ストーリー攻略/第X話) %EF%BD%9E(.+?)%E3%83%BB(.+?)\.html
# 置換先: docs/%1-%2-%3/

# **第3話〜クラブ・ストロング戦.html**
RewriteCond %{QUERY_STRING} ^(%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AA%E3%83%BC%E6%94%BB%E7%95%A5/%E7%AC%AC3%E8%A9%B1)%EF%BD%9E(.+?)%E3%83%BB(.+?)\.html$
RewriteRule ^$ docs/%1-%2-%3/ [R=301,NE,QSD,L]

# **第4話〜クイーン・ヴァルゴ戦.html**
RewriteCond %{QUERY_STRING} ^(%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AA%E3%83%BC%E6%94%BB%E7%95%A5/%E7%AC%AC4%E8%A9%B1)%EF%BD%9E(.+?)%E3%83%BB(.+?)\.html$
RewriteRule ^$ docs/%1-%2-%3/ [R=301,NE,QSD,L]

# **第6話〜グレイブ・ジョーカー戦.html**
RewriteCond %{QUERY_STRING} ^(%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AA%E3%83%BC%E6%94%BB%E7%95%A5/%E7%AC%AC6%E8%A9%B1)%EF%BD%9E(.+?)%E3%83%BB(.+?)\.html$
RewriteRule ^$ docs/%1-%2-%3/ [R=301,NE,QSD,L]


# ----------------------------------------------------
# 3. 通常のURL（.htmlで終わり、上記置換ルールにマッチしないもの）を /docs/ にリダイレクト
#    -> ストーリー攻略以外のほとんどのファイルがここにマッチします。
# ----------------------------------------------------
# 例: サテライトサーバー.html -> docs/サテライトサーバー/
RewriteCond %{QUERY_STRING} ^(.+?)\.html$
RewriteRule ^$ docs/%1/ [R=301,NE,QSD,L]


# ----------------------------------------------------
# 4. クエリ文字列なしのURL (/ryusei3/) をリダイレクト
# ----------------------------------------------------
RewriteCond %{QUERY_STRING} ^$
RewriteRule ^$ index.html [R=301,L]